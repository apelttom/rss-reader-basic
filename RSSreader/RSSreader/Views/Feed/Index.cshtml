@model IEnumerable<RSSreader.Models.Feed>

@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h1>Your RSS feeds:</h1>

<p>
    <a asp-action="Create">
        <button type="button">
            <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24">
                    <path fill="currentColor" fill-rule="evenodd" d="M2.25 13.045a.75.75 0 0 1 .75-.75A8.706 8.706 0 0 1 11.705 21a.75.75 0 0 1-1.5 0A7.205 7.205 0 0 0 3 13.795a.75.75 0 0 1-.75-.75" clip-rule="evenodd"></path>
                    <path fill="currentColor" fill-rule="evenodd" d="M2.25 6.857a.75.75 0 0 1 .75-.75A14.893 14.893 0 0 1 17.893 21a.75.75 0 0 1-1.5 0A13.393 13.393 0 0 0 3 7.607a.75.75 0 0 1-.75-.75M3.884 19.982a.134.134 0 1 0 0 .268.134.134 0 0 0 0-.268m-1.634.134a1.634 1.634 0 1 1 3.268 0 1.634 1.634 0 0 1-3.268 0M18.857 2.679a.75.75 0 0 1 .75.75V8.57a.75.75 0 0 1-1.5 0V3.43a.75.75 0 0 1 .75-.75" clip-rule="evenodd"></path>
                    <path fill="currentColor" fill-rule="evenodd" d="M15.536 6a.75.75 0 0 1 .75-.75h5.143a.75.75 0 0 1 0 1.5h-5.143a.75.75 0 0 1-.75-.75" clip-rule="evenodd"></path>
                </svg>
            </span>
        </button>
    </a>
    <a asp-action="ReloadArticles">
        <button type="button">
            <span>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                    <g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5">
                        <path d="M4.07 12.629c0 4.065 3.059 7.512 7.175 8.087s8.039-1.896 9.204-5.799c1.166-3.902-.78-8.05-4.566-9.73-3.787-1.681-8.26-.385-10.499 3.042"></path>
                        <path d="M5.357 3.2v5.029H10.5"></path>
                    </g>
                </svg>
            </span>
        </button>
    </a>
</p>

<!-- Button to toggle the filter form -->
<button class="btn btn-link p-0" type="button" data-bs-toggle="collapse" data-bs-target="#filterForm" aria-expanded="false" aria-controls="filterForm" style="text-decoration: underline;">
    Filter Articles
</button>

<!-- Collapsible filter form -->
<div class="collapse" id="filterForm">
    <form method="get" asp-action="Index" class="row g-3">
        <div class="col-1">
            <label for="fromDate" class="form-label">Published From</label>
            <input type="date" id="fromDate" name="fromDate" class="form-control form-control-sm" value="@ViewData["FromDate"]">
        </div>
        <div class="col-1">
            <label for="toDate" class="form-label">Published To</label>
            <input type="date" id="toDate" name="toDate" class="form-control form-control-sm" value="@ViewData["ToDate"]">
        </div>
        <div class="col-2 align-self-end">
            <button type="submit" class="btn btn-primary btn-sm">Filter</button>
        </div>
    </form>
</div>

<table class="table">
    <thead>
        <tr>
            <th>
                @Html.DisplayNameFor(model => model.FeedTitle)
            </th>
            <th>
                @Html.DisplayNameFor(model => model.FeedLink)
            </th>
            <th></th>
        </tr>
    </thead>
    <tbody>
@foreach (var item in Model) {
    <tr class="feed-row">
        <td data-bs-toggle="collapse" data-bs-target="#articles-@item.FeedId">
            @Html.DisplayFor(modelItem => item.FeedTitle)
        </td>
        <td data-bs-toggle="collapse" data-bs-target="#articles-@item.FeedId">
            @Html.DisplayFor(modelItem => item.FeedLink)
        </td>
        <td>
            <a asp-action="Edit" asp-route-id="@item.FeedId">Edit</a> |
            <a asp-action="Details" asp-route-id="@item.FeedId">Details</a> |
            <a asp-action="Delete" asp-route-id="@item.FeedId">Delete</a>
        </td>
    </tr>
    <tr class="collapse" id="articles-@item.FeedId">
        <td colspan="3">
            <ul class="list-group">
                @foreach (var article in item.Articles)
                {
                    <li class="list-group-item">
                        @article.Title - <a href="@article.Link" target="_blank">Read</a> (@article.PublishDate)
                    </li>
                }
            </ul>
        </td>
    </tr>
}
    </tbody>
</table>
